@model IEnumerable<Shop.BLL.Models.GoodDTO>

@{
    ViewBag.Title = "Index";
}

<h2>Список товаров</h2>

<p>
    @Html.ActionLink("Create New", "Edit", new { id = 0 }, new { @class = "btn-sm btn-primary" })
<p>
    <table class="table">
        <tr>
            @*<th>
                    @Html.DisplayNameFor(model => model.GoodId)
                </th>*@
            <th>
                @Html.DisplayNameFor(model => model.GoodName)
            </th>

            <th>
                @Html.DisplayNameFor(model => model.ManufacturerName)
            </th>

            <th>
                @Html.DisplayNameFor(model => model.CategoryName)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Price)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.GoodCount)
            </th>
            <th></th>
        </tr>

        @foreach (var item in Model)
        {
            <tr>

                <td>
                    @Html.DisplayFor(modelItem => item.GoodName)
                </td>

                <td>
                    @Html.DisplayFor(modelItem => item.ManufacturerName)
                </td>

                <td>
                    @Html.DisplayFor(modelItem => item.CategoryName)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Price)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.GoodCount)
                </td>
                <td>

                    @if (User.IsInRole("Admin") || User.IsInRole("AppAdmin"))
                    {


                    }
                    else
                    {
                        @Html.ActionLink("Add to cart", "AddToCart", "Cart", new { goodId = item.GoodId, returnUrl = Request.Url.PathAndQuery }, new { @class = "btn-sm btn-success" })
                        @Html.ActionLink("Details", "Details", new { id = item.GoodId }, new { @class = "btn-sm btn-info" })
                      
                        @*Html.ActionLink("Edit Photo", "ListPhoto", "PhotoAll", new { id = item.Id }, new { @class = "btn-sm btn-primary" })*@
                        @Html.ActionLink("Edit", "Edit", new { id = item.GoodId }, new { @class = "btn-sm btn-success" })
                        @Html.ActionLink("Delete", "Delete", new { id = item.GoodId }, new { @class = "btn-sm btn-danger delGood", data_id = item.GoodId })

                    }

                </td>
            </tr>
        }

    </table>
    @section ScriptsGood{
        <script type="text/javascript">
                    $(function () {
                        $(".delGood").click(function (e) {
                            e.preventDefault()
                            if (confirm('Do you want to delete this good?')) {
                                $.ajax({
                                    url: "@Url.Action("Delete", "Good")",
                                    data: { id: $(this).attr('data-id') },
                                    type: 'POST',
                                    success: function (data) {
                                        if (data == "OK")
                                            window.location.href = "@Url.Action("Index", "Good")"
                                        else
                                            alert(data);
                                    },
                                    error: function (data) {
                                        alert(data);
                                    }
                                });
                            }
                        });
                    });
        </script>
    }

